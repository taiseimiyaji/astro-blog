<!DOCTYPE html><html lang="ja"> <head><title>生成AI時代に見直すスキーマ駆動開発</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta name="description" content="> **この記事の対象読者**: フロントエンド／バックエンド開発者、技術選定に関わるリード／アーキテクト、生成AIを開発ワークフローに組み込みたいエンジニア。  
> **この記事でわかること**: スキーマ駆動開発（Schema‑Dri"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZBD90YGZ4N"></script><style>@charset "UTF-8";html{background-color:#23272f;font-size:16px;color:#f6f7f9}.header{color:#f6f7f9;justify-content:space-around;border-bottom:.5px solid}.header-link{display:flex;justify-content:space-around;font-size:1.5rem;padding:.5rem;border-color:#f6f7f9;margin:0 auto;max-width:70rem;width:94vw}.header-link div{color:#f6f7f9}.header .title{border-bottom:.5px solid;text-align:center;font-weight:700;padding:2rem;font-size:2.5rem}.card{box-sizing:border-box;background-color:#23272f;border:1px solid #F6F7F9;border-radius:1rem;display:flex;flex-direction:column;padding:2rem;gap:1rem;color:#f6f7f9}.card .title{font-size:large;overflow:inherit}.card:hover{background-color:#2d3748;color:#fff;box-shadow:0 6px 8px #00000026}.card-list{gap:1rem;flex-direction:column;display:flex}code{font-size:1rem}:root{--accent: 124, 58, 237;--accent-gradient: linear-gradient(45deg, rgb(var(--accent)), #da62c4 30%, white 60%)}html{font-family:system-ui,sans-serif}code{font-family:Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace}.content{padding:2rem 0;margin:0 auto;max-width:70rem;width:94vw}.content .post{overflow-wrap:normal;overflow:hidden}.content p,.content ul li,.content ol li{line-height:1.7}a{color:#f6f7f9;text-decoration:none}img{width:100%}*,*:before,*:after{box-sizing:border-box}.card-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(min(250px,100%),1fr));gap:1rem;padding:1rem}.sns-button{display:flex;align-items:center;justify-content:center;background-color:#23272f;border:1px solid white;color:#fff;padding:1rem;border-radius:.5rem;box-shadow:0 4px 6px #0000001a;transition:background-color .3s ease,box-shadow .3s ease;width:100%;max-width:100%;text-align:center;font-size:1.25rem;cursor:pointer;margin:0}.sns-button:hover{background-color:#2d3748;color:#fff;box-shadow:0 6px 8px #00000026}.sns-button svg{stroke:currentColor;fill:currentColor;stroke-width:0;height:1.5em;width:1.5em;margin-right:.5rem}pre.astro-code.github-dark{background-color:#2d333b!important;overflow-x:auto;padding:1rem;border-radius:.2rem}.footer{border-top:1px solid #F6F7F9;padding:1rem;align-items:center;display:flex;max-height:2rem}.footer .copyright{order:1}.footer .icons{margin-left:auto;order:2;width:2rem;height:2rem}
html{background-color:#23272f;font-size:16px;color:#f6f7f9}.header{color:#f6f7f9;justify-content:space-around;border-bottom:.5px solid}.header-link{display:flex;justify-content:space-around;font-size:1.5rem;padding:.5rem;border-color:#f6f7f9;margin:0 auto;max-width:70rem;width:94vw}.header-link div{color:#f6f7f9}.header .title{border-bottom:.5px solid;text-align:center;font-weight:700;padding:2rem;font-size:2.5rem}.footer{border-top:1px solid #F6F7F9;padding:1rem;align-items:center;display:flex;max-height:2rem}.footer .copyright{order:1}.footer .icons{margin-left:auto;order:2;width:2rem;height:2rem}.card{box-sizing:border-box;background-color:#23272f;border:1px solid #F6F7F9;border-radius:1rem;display:flex;flex-direction:column;padding:2rem;gap:1rem;color:#f6f7f9}.card .title{font-size:large;overflow:inherit}.card:hover{background-color:#2d3748;color:#fff;box-shadow:0 6px 8px #00000026}.card-list{gap:1rem;flex-direction:column;display:flex}.content a{text-decoration:underline}.content table{width:100%;border-collapse:collapse;margin:2rem 0}.content table th,.content table td{border:1px solid #F6F7F9;padding:.5rem;text-align:left}.content table th{background-color:#f6f7f933;color:#f6f7f9;font-weight:700}.content table tr:nth-child(odd){background-color:#f6f7f91a}.content table tr:nth-child(2n){background-color:#f6f7f90d}.content blockquote{padding:1rem;margin:1rem 0;border-left:4px solid #F6F7F9;background-color:#f6f7f91a;color:#f6f7f9;font-style:italic;overflow-wrap:break-word}.content blockquote p{margin:0}.content h2{color:#f6f7f9;margin:2rem 0 1rem;font-size:1.5rem;font-weight:700;border-bottom:2px solid #F6F7F9;padding-bottom:.5rem}
</style></head> <!-- Google tag (gtag.js) --> <script type="module">window.dataLayer=window.dataLayer||[];function a(){dataLayer.push(arguments)}a("js",new Date);a("config","G-ZBD90YGZ4N");</script> <body> <main> <div class="header"><div class="title"><a href="/">Lyricrime.com</a></div><div class="header-link"><a href="/"><div> Blog</div></a><a href="/profile"><div>Profile</div></a></div></div> <div class="content"> <div class="date">2025/07/18</div> <h1>生成AI時代に見直すスキーマ駆動開発</h1> <div class="post"> <blockquote>
<p><strong>この記事の対象読者</strong>: フロントエンド／バックエンド開発者、技術選定に関わるリード／アーキテクト、生成AIを開発ワークフローに組み込みたいエンジニア。<br>
<strong>この記事でわかること</strong>: スキーマ駆動開発（Schema‑Driven Development: SDD）の基本、OpenAPIからTypeSpecへの進化、Zodを活用した型安全フロントエンド、AI活用時のコンテキスト削減戦略、CI/CDで契約（Contract）を壊さない仕組み。</p>
</blockquote>
<h2 id="1-はじめになぜ-ai--スキーマ駆動開発-なのか">1. はじめに：なぜ “AI × スキーマ駆動開発” なのか</h2>
<p>生成AI（LLM）を開発に取り入れてみたものの、「プロンプトで説明した仕様」と「実際の実装」がズレてしまうことはありませんか？<br>
2025年現在、生成AIは <strong>一度の指示で完璧にコードを出力するより、複数回の対話で目的地に近づく</strong> 方向に進化しています。<br>
曖昧な自然言語より <strong>機械にも人間にも解釈が一意な “スキーマ”</strong> をハブとして共有すると、AI との協調開発でもズレを抑えられます。</p>
<h2 id="2-スキーマ駆動開発とは">2. スキーマ駆動開発とは</h2>
<p><strong>スキーマ駆動開発（Schema‑Driven Development / Contract‑First / Spec‑First）</strong> とは、コードより先に API・イベント・データモデルなどの仕様を “スキーマ” として定義し、それを <em>ソース・オブ・トゥルース</em> として実装・テスト・ドキュメンテーションを派生生成していく開発スタイルです。</p>
<p>下記の矢印はAPIコールを示し、点線部分はそれぞれtypesとstubsを生成できることを示しています。</p>
<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 737.015625 219.57632446289062" style="max-width: 737.015625px;" class="flowchart" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-0"><style>#mermaid-0{font-family:arial,sans-serif;font-size:16px;fill:#ccc;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-0 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-0 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-0 .error-icon{fill:#a44141;}#mermaid-0 .error-text{fill:#ddd;stroke:#ddd;}#mermaid-0 .edge-thickness-normal{stroke-width:1px;}#mermaid-0 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-0 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-0 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-0 .marker{fill:#6b7280;stroke:#6b7280;}#mermaid-0 .marker.cross{stroke:#6b7280;}#mermaid-0 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-0 p{margin:0;}#mermaid-0 .label{font-family:arial,sans-serif;color:#f3f4f6;}#mermaid-0 .cluster-label text{fill:#f3f4f6;}#mermaid-0 .cluster-label span{color:#f3f4f6;}#mermaid-0 .cluster-label span p{background-color:transparent;}#mermaid-0 .label text,#mermaid-0 span{fill:#f3f4f6;color:#f3f4f6;}#mermaid-0 .node rect,#mermaid-0 .node circle,#mermaid-0 .node ellipse,#mermaid-0 .node polygon,#mermaid-0 .node path{fill:#1f2937;stroke:#ccc;stroke-width:1px;}#mermaid-0 .rough-node .label text,#mermaid-0 .node .label text,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-anchor:middle;}#mermaid-0 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-0 .rough-node .label,#mermaid-0 .node .label,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-align:center;}#mermaid-0 .node.clickable{cursor:pointer;}#mermaid-0 .root .anchor path{fill:#6b7280!important;stroke-width:0;stroke:#6b7280;}#mermaid-0 .arrowheadPath{fill:lightgrey;}#mermaid-0 .edgePath .path{stroke:#6b7280;stroke-width:2.0px;}#mermaid-0 .flowchart-link{stroke:#6b7280;fill:none;}#mermaid-0 .edgeLabel{background-color:#1f2937;text-align:center;}#mermaid-0 .edgeLabel p{background-color:#1f2937;}#mermaid-0 .edgeLabel rect{opacity:0.5;background-color:#1f2937;fill:#1f2937;}#mermaid-0 .labelBkg{background-color:rgba(31, 41, 55, 0.5);}#mermaid-0 .cluster rect{fill:#1f2937;stroke:#6b7280;stroke-width:1px;}#mermaid-0 .cluster text{fill:#f3f4f6;}#mermaid-0 .cluster span{color:#f3f4f6;}#mermaid-0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:#1f2937;border:1px solid rgba(255, 255, 255, 0.25);border-radius:2px;pointer-events:none;z-index:100;}#mermaid-0 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#ccc;}#mermaid-0 rect.text{fill:none;stroke-width:0;}#mermaid-0 .icon-shape,#mermaid-0 .image-shape{background-color:#1f2937;text-align:center;}#mermaid-0 .icon-shape p,#mermaid-0 .image-shape p{background-color:#1f2937;padding:2px;}#mermaid-0 .icon-shape rect,#mermaid-0 .image-shape rect{opacity:0.5;background-color:#1f2937;fill:#1f2937;}#mermaid-0 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-0 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-0 :root{--mermaid-font-family:arial,sans-serif;}#mermaid-0 .area>*{fill:#F3F4F6!important;stroke:#999!important;stroke-width:1px!important;}#mermaid-0 .area span{fill:#F3F4F6!important;stroke:#999!important;stroke-width:1px!important;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-0_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-0_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-0_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-0_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-0_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-0_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="BACKEND" class="cluster"><rect height="191.78815841674805" width="187.359375" y="8" x="541.65625" style=""></rect><g transform="translate(604.203125, 8)" class="cluster-label"><foreignObject height="24" width="62.265625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Backend</p></span></div></foreignObject></g></g><g data-look="classic" id="FRONTEND" class="cluster"><rect height="191.78815841674805" width="193.015625" y="8" x="8" style=""></rect><g transform="translate(72.484375, 8)" class="cluster-label"><foreignObject height="24" width="64.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Frontend</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#mermaid-0_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_FE_BE_0" d="M156.733,81.894L164.113,78.078C171.494,74.263,186.255,66.631,200.989,62.816C215.724,59,230.432,59,258.819,59C287.206,59,329.271,59,371.336,59C413.401,59,455.466,59,483.853,59C512.24,59,526.948,59,540.878,62.502C554.808,66.005,567.959,73.009,574.535,76.511L581.111,80.014"></path><path style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_FE_Schema_0" d="M156.733,135.894L164.113,139.71C171.494,143.525,186.255,151.157,200.989,154.972C215.724,158.788,230.432,158.788,245.141,158.788C259.849,158.788,274.557,158.788,281.911,158.788L289.266,158.788"></path><path style="" class="edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Schema_BE_0" d="M453.406,158.788L460.76,158.788C468.115,158.788,482.823,158.788,497.531,158.788C512.24,158.788,526.948,158.788,541.466,154.972C555.985,151.157,570.313,143.525,577.477,139.71L584.642,135.894"></path></g><g class="edgeLabels"><g transform="translate(371.3359375, 59)" class="edgeLabel"><g transform="translate(-20.890625, -12)" class="label"><foreignObject height="24" width="41.78125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>HTTP</p></span></div></foreignObject></g></g><g transform="translate(245.140625, 158.78815841674805)" class="edgeLabel"><g transform="translate(-19.125, -12)" class="label"><foreignObject height="24" width="38.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>types</p></span></div></foreignObject></g></g><g transform="translate(497.53125, 158.78815841674805)" class="edgeLabel"><g transform="translate(-19.125, -12)" class="label"><foreignObject height="24" width="38.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>stubs</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(104.5078125, 108.89407920837402)" id="flowchart-FE-0" class="node default"><rect height="54" width="143.015625" y="-27" x="-71.5078125" style="" class="basic label-container"></rect><g transform="translate(-41.5078125, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="83.015625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>React / Vue</p></span></div></foreignObject></g></g><g transform="translate(371.3359375, 158.78815841674805)" id="flowchart-Schema-1" class="node default"><path transform="translate(-82.0703125, -52.78816536071332)" style="" class="basic label-container" d="M0,14.192110240475547 a82.0703125,14.192110240475547 0,0,0 164.140625,0 a82.0703125,14.192110240475547 0,0,0 -164.140625,0 l0,77.19211024047554 a82.0703125,14.192110240475547 0,0,0 164.140625,0 l0,-77.19211024047554"></path><g transform="translate(-74.5703125, -14)" style="" class="label"><rect></rect><foreignObject height="48" width="149.140625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Schema<br></br>OpenAPI / TypeSpec</p></span></div></foreignObject></g></g><g transform="translate(635.3359375, 108.89407920837402)" id="flowchart-BE-2" class="node default"><rect height="54" width="137.359375" y="-27" x="-68.6796875" style="" class="basic label-container"></rect><g transform="translate(-38.6796875, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="77.359375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>API Server</p></span></div></foreignObject></g></g></g></g></g></svg>
<h3 id="21-スキーマ駆動開発で扱う主なアーティファクト">2.1 スキーマ駆動開発で扱う主なアーティファクト</h3>






























<table><thead><tr><th>活用先</th><th>自動生成できるもの</th><th>期待効果</th></tr></thead><tbody><tr><td>フロントエンド</td><td>型定義 / API クライアント / モック</td><td>実装の早期開始・型安全化</td></tr><tr><td>バックエンド</td><td>サーバースタブ / ルーティング雛形 / 入力バリデーション</td><td>一貫した契約遵守・漏れ検出</td></tr><tr><td>QA/テスト</td><td>契約テスト / スキーマベーステストケース</td><td>正常系/異常系の抜け漏れ削減</td></tr><tr><td>ドキュメント</td><td>API リファレンス / ER 図</td><td>更新コスト削減</td></tr></tbody></table>
<hr>
<h2 id="3-openapi-の功績と限界">3. OpenAPI の功績と限界</h2>
<p>OpenAPI（旧 Swagger）は REST API の事実上の標準仕様として広く普及し、ツール連携（コード生成・モック・UIドキュメント）が充実しています。
ただしプロジェクトが大規模になると次の課題が顕在化します。</p>
<ul>
<li>YAML/JSON が冗長で DRY に保ちづらい</li>
<li>型再利用やテンプレート化が複雑</li>
<li>モジュール分割・合成戦略がプロダクト／ツール依存</li>
</ul>
<p>そこで登場するのが <strong>TypeSpec</strong> です。TypeScript ライクな宣言型 DSL で、<strong>再利用性・テンプレート性・モジュール化</strong> が高く、OpenAPI へのエクスポートも可能です。</p>
<p>参考:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/developer/typespec/overview">TypeSpec の概要 (Microsoft Learn)</a></li>
<li><a href="https://zenn.dev/kimuson/articles/typespec_openapi">TypeSpec が OpenAPI や JSON Schema を書くのに良かったので紹介する</a></li>
</ul>
<h3 id="typespecの例">TypeSpecの例</h3>
<p>以下に、<strong>TODO</strong> という単一リソースに対する CRUD をそれぞれ <strong>OpenAPI 3.1</strong> と <strong>TypeSpec</strong> で記述したサンプルを示します。</p>
<p>記述量の差とわかりやすさに注目してみてください。</p>
<h3 id="1-openapi31-仕様例yaml">1. OpenAPI 3.1 仕様例（YAML）</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#85E89D">openapi</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">3.1.0</span></span>
<span class="line"><span style="color:#85E89D">info</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  title</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Todo API</span></span>
<span class="line"><span style="color:#85E89D">  version</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"1.0.0"</span></span>
<span class="line"><span style="color:#85E89D">servers</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">  - </span><span style="color:#85E89D">url</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">https://api.example.com</span></span>
<span class="line"><span style="color:#85E89D">paths</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  /todos</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    get</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">      summary</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Todo一覧を取得</span></span>
<span class="line"><span style="color:#85E89D">      operationId</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">listTodos</span></span>
<span class="line"><span style="color:#85E89D">      responses</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">        "200"</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          description</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">一覧取得成功</span></span>
<span class="line"><span style="color:#85E89D">          content</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">            application/json</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">              schema</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">                type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">array</span></span>
<span class="line"><span style="color:#85E89D">                items</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">                  $ref</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"#/components/schemas/Todo"</span></span>
<span class="line"><span style="color:#85E89D">    post</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">      summary</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Todoを新規作成</span></span>
<span class="line"><span style="color:#85E89D">      operationId</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">createTodo</span></span>
<span class="line"><span style="color:#85E89D">      requestBody</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">        required</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">true</span></span>
<span class="line"><span style="color:#85E89D">        content</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          application/json</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">            schema</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">              $ref</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"#/components/schemas/CreateTodo"</span></span>
<span class="line"><span style="color:#85E89D">      responses</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">        "201"</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          description</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">作成成功</span></span>
<span class="line"><span style="color:#85E89D">          content</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">            application/json</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">              schema</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">                $ref</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"#/components/schemas/Todo"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">  /todos/{id}</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    parameters</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#E1E4E8">      - </span><span style="color:#85E89D">name</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">id</span></span>
<span class="line"><span style="color:#85E89D">        in</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">path</span></span>
<span class="line"><span style="color:#85E89D">        required</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">true</span></span>
<span class="line"><span style="color:#85E89D">        schema</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">string</span></span>
<span class="line"><span style="color:#85E89D">    get</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">      summary</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Todoを取得</span></span>
<span class="line"><span style="color:#85E89D">      operationId</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">getTodo</span></span>
<span class="line"><span style="color:#85E89D">      responses</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">        "200"</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          description</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">取得成功</span></span>
<span class="line"><span style="color:#85E89D">          content</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">            application/json</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">              schema</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">                $ref</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"#/components/schemas/Todo"</span></span>
<span class="line"><span style="color:#9ECBFF">        "404"</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          description</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">見つからない</span></span>
<span class="line"><span style="color:#85E89D">    put</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">      summary</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Todoを更新</span></span>
<span class="line"><span style="color:#85E89D">      operationId</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">updateTodo</span></span>
<span class="line"><span style="color:#85E89D">      requestBody</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">        required</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">true</span></span>
<span class="line"><span style="color:#85E89D">        content</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          application/json</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">            schema</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">              $ref</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"#/components/schemas/UpdateTodo"</span></span>
<span class="line"><span style="color:#85E89D">      responses</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">        "200"</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          description</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">更新成功</span></span>
<span class="line"><span style="color:#85E89D">          content</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">            application/json</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">              schema</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">                $ref</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">"#/components/schemas/Todo"</span></span>
<span class="line"><span style="color:#85E89D">    delete</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">      summary</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">Todoを削除</span></span>
<span class="line"><span style="color:#85E89D">      operationId</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">deleteTodo</span></span>
<span class="line"><span style="color:#85E89D">      responses</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#9ECBFF">        "204"</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          description</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">削除成功（内容なし）</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">components</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">  schemas</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">    Todo</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">      type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">object</span></span>
<span class="line"><span style="color:#85E89D">      required</span><span style="color:#E1E4E8">: [</span><span style="color:#9ECBFF">id</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">title</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">completed</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">createdAt</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#85E89D">      properties</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">        id</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">string</span></span>
<span class="line"><span style="color:#85E89D">          format</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">uuid</span></span>
<span class="line"><span style="color:#85E89D">        title</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">string</span></span>
<span class="line"><span style="color:#85E89D">          maxLength</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">255</span></span>
<span class="line"><span style="color:#85E89D">        completed</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">boolean</span></span>
<span class="line"><span style="color:#85E89D">        createdAt</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">string</span></span>
<span class="line"><span style="color:#85E89D">          format</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">date-time</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">    CreateTodo</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">      type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">object</span></span>
<span class="line"><span style="color:#85E89D">      required</span><span style="color:#E1E4E8">: [</span><span style="color:#9ECBFF">title</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#85E89D">      properties</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">        title</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">string</span></span>
<span class="line"><span style="color:#85E89D">          maxLength</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">255</span></span>
<span class="line"><span style="color:#85E89D">        completed</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">boolean</span></span>
<span class="line"><span style="color:#85E89D">          default</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">    UpdateTodo</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">      type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">object</span></span>
<span class="line"><span style="color:#85E89D">      properties</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">        title</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">string</span></span>
<span class="line"><span style="color:#85E89D">          maxLength</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">255</span></span>
<span class="line"><span style="color:#85E89D">        completed</span><span style="color:#E1E4E8">:</span></span>
<span class="line"><span style="color:#85E89D">          type</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">boolean</span></span></code></pre>
<hr>
<h3 id="2-typespec-仕様例tsp">2. TypeSpec 仕様例（<code>.tsp</code>）</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="tsp"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#9ECBFF"> "@typespec/rest"</span><span style="color:#E1E4E8">; </span><span style="color:#6A737D">// HTTP ライブラリを読み込み</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">@service</span><span style="color:#E1E4E8">({ </span><span style="color:#FFAB70">title</span><span style="color:#F97583">:</span><span style="color:#9ECBFF"> "Todo API"</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">version</span><span style="color:#F97583">:</span><span style="color:#9ECBFF"> "1.0.0"</span><span style="color:#E1E4E8"> })</span></span>
<span class="line"><span style="color:#F97583">namespace</span><span style="color:#B392F0"> TodoApi</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">/*------------------------------</span></span>
<span class="line"><span style="color:#6A737D"> *  モデル定義</span></span>
<span class="line"><span style="color:#6A737D"> *-----------------------------*/</span></span>
<span class="line"><span style="color:#F97583">model</span><span style="color:#B392F0"> Todo</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#FFAB70">  id</span><span style="color:#F97583">:</span><span style="color:#B392F0"> string</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">  title</span><span style="color:#F97583">:</span><span style="color:#B392F0"> string</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">  completed</span><span style="color:#F97583">:</span><span style="color:#B392F0"> boolean</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">  createdAt</span><span style="color:#F97583">:</span><span style="color:#B392F0"> utcDateTime</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">model</span><span style="color:#B392F0"> CreateTodo</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#FFAB70">  title</span><span style="color:#F97583">:</span><span style="color:#B392F0"> string</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">  completed</span><span style="color:#F97583">?:</span><span style="color:#B392F0"> boolean</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">model</span><span style="color:#B392F0"> UpdateTodo</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#FFAB70">  title</span><span style="color:#F97583">?:</span><span style="color:#B392F0"> string</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#FFAB70">  completed</span><span style="color:#F97583">?:</span><span style="color:#B392F0"> boolean</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">/*------------------------------</span></span>
<span class="line"><span style="color:#6A737D"> *  エンドポイント</span></span>
<span class="line"><span style="color:#6A737D"> *-----------------------------*/</span></span>
<span class="line"><span style="color:#85E89D">@route</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"/todos"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">interface</span><span style="color:#B392F0"> Todos</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#85E89D">  @get</span><span style="color:#B392F0"> list</span><span style="color:#E1E4E8">()</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Todo</span><span style="color:#E1E4E8">[];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">  @post</span><span style="color:#B392F0"> create</span><span style="color:#E1E4E8">(</span><span style="color:#85E89D">@body</span><span style="color:#FFAB70"> CreateTodo</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Todo</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">@route</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"/todos/{id}"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">interface</span><span style="color:#B392F0"> TodoItem</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#85E89D">  @get</span><span style="color:#B392F0"> read</span><span style="color:#E1E4E8">(</span><span style="color:#85E89D">@path</span><span style="color:#FFAB70"> id</span><span style="color:#F97583">:</span><span style="color:#B392F0"> string</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Todo</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">  @put</span><span style="color:#B392F0"> update</span><span style="color:#E1E4E8">(</span><span style="color:#85E89D">@path</span><span style="color:#FFAB70"> id</span><span style="color:#F97583">:</span><span style="color:#B392F0"> string</span><span style="color:#E1E4E8">, </span><span style="color:#85E89D">@body</span><span style="color:#FFAB70"> UpdateTodo</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Todo</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D">  @delete</span><span style="color:#B392F0"> delete</span><span style="color:#E1E4E8">(</span><span style="color:#85E89D">@path</span><span style="color:#FFAB70"> id</span><span style="color:#F97583">:</span><span style="color:#B392F0"> string</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> void</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="4-ai-開発におけるコンテキスト削減の重要性">4. AI 開発におけるコンテキスト削減の重要性</h2>
<p>LLM に仕様を伝える際、自然言語で長々説明するとトークンコストも曖昧さも増えます。
<strong>スキーマをプロンプトに直接差し込めば</strong>、トークン数を削減しつつ構造化された「正規の仕様」を共有できます。</p>
<h2 id="5-フロントエンド編zod-による型安全--バリデーション">5. フロントエンド編：Zod による型安全 &#x26; バリデーション</h2>
<h3 id="51-最小-zod-例">5.1 最小 Zod 例</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { z } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "zod"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> UserSchema</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> z.</span><span style="color:#B392F0">object</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">  id: z.</span><span style="color:#B392F0">string</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">uuid</span><span style="color:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#E1E4E8">  name: z.</span><span style="color:#B392F0">string</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">min</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">),</span></span>
<span class="line"><span style="color:#E1E4E8">  age: z.</span><span style="color:#B392F0">number</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">int</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">nonnegative</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">optional</span><span style="color:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">type</span><span style="color:#B392F0"> User</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> z</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">infer</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#F97583">typeof</span><span style="color:#E1E4E8"> UserSchema>;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">async</span><span style="color:#F97583"> function</span><span style="color:#B392F0"> fetchUser</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">id</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Promise</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">User</span><span style="color:#E1E4E8">> {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> res</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> fetch</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">`/api/users/${</span><span style="color:#E1E4E8">id</span><span style="color:#9ECBFF">}`</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> data</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#E1E4E8"> res.</span><span style="color:#B392F0">json</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> UserSchema.</span><span style="color:#B392F0">parse</span><span style="color:#E1E4E8">(data); </span><span style="color:#6A737D">// 不整合なら例外</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="52-openapi--typespec-から-zod-スキーマを生成する">5.2 OpenAPI / TypeSpec から Zod スキーマを生成する</h3>
<p>手書き Zod もよいですが、<strong>仕様 → 自動生成 → 型＆ランタイム検証同時反映</strong> が SDD の真骨頂です。
利用ツール例:</p>
<ul>
<li><code>openapi-zod-client</code></li>
<li><code>zod-openapi</code>（スキーマ相互変換）</li>
<li>内製スクリプト: TypeSpec → OpenAPI → Zod 型生成</li>
</ul>
<hr>
<h2 id="6-cicd-編契約を壊さないパイプライン">6. CI/CD 編：契約を壊さないパイプライン</h2>
<blockquote>
<p>❗ <strong>ポイント</strong>: スキーマが “真実” である以上、ズレれば全レイヤーが破綻します。CI/CD で自動チェックし、壊れた PR を止める仕組みが不可欠です。</p>
</blockquote>
<h3 id="61-パイプライン全体像">6.1 パイプライン全体像</h3>
<ol>
<li><strong>PR でスキーマ差分を検出</strong></li>
<li><strong>コード生成を再実行し差分比較</strong>（フロント型 / サーバースタブ）</li>
<li><strong>契約テスト</strong>（実装 vs スキーマ ／ モックサーバー）</li>
<li><strong>ブレイキングチェンジ検知</strong>（必須化・型削除・互換性破壊）</li>
</ol>
<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 248.32421875 406" style="max-width: 248.32421875px;" class="flowchart" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-1"><style>#mermaid-1{font-family:arial,sans-serif;font-size:16px;fill:#ccc;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-1 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-1 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-1 .error-icon{fill:#a44141;}#mermaid-1 .error-text{fill:#ddd;stroke:#ddd;}#mermaid-1 .edge-thickness-normal{stroke-width:1px;}#mermaid-1 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-1 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1 .marker{fill:#6b7280;stroke:#6b7280;}#mermaid-1 .marker.cross{stroke:#6b7280;}#mermaid-1 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-1 p{margin:0;}#mermaid-1 .label{font-family:arial,sans-serif;color:#f3f4f6;}#mermaid-1 .cluster-label text{fill:#f3f4f6;}#mermaid-1 .cluster-label span{color:#f3f4f6;}#mermaid-1 .cluster-label span p{background-color:transparent;}#mermaid-1 .label text,#mermaid-1 span{fill:#f3f4f6;color:#f3f4f6;}#mermaid-1 .node rect,#mermaid-1 .node circle,#mermaid-1 .node ellipse,#mermaid-1 .node polygon,#mermaid-1 .node path{fill:#1f2937;stroke:#ccc;stroke-width:1px;}#mermaid-1 .rough-node .label text,#mermaid-1 .node .label text,#mermaid-1 .image-shape .label,#mermaid-1 .icon-shape .label{text-anchor:middle;}#mermaid-1 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-1 .rough-node .label,#mermaid-1 .node .label,#mermaid-1 .image-shape .label,#mermaid-1 .icon-shape .label{text-align:center;}#mermaid-1 .node.clickable{cursor:pointer;}#mermaid-1 .root .anchor path{fill:#6b7280!important;stroke-width:0;stroke:#6b7280;}#mermaid-1 .arrowheadPath{fill:lightgrey;}#mermaid-1 .edgePath .path{stroke:#6b7280;stroke-width:2.0px;}#mermaid-1 .flowchart-link{stroke:#6b7280;fill:none;}#mermaid-1 .edgeLabel{background-color:#1f2937;text-align:center;}#mermaid-1 .edgeLabel p{background-color:#1f2937;}#mermaid-1 .edgeLabel rect{opacity:0.5;background-color:#1f2937;fill:#1f2937;}#mermaid-1 .labelBkg{background-color:rgba(31, 41, 55, 0.5);}#mermaid-1 .cluster rect{fill:#1f2937;stroke:#6b7280;stroke-width:1px;}#mermaid-1 .cluster text{fill:#f3f4f6;}#mermaid-1 .cluster span{color:#f3f4f6;}#mermaid-1 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:#1f2937;border:1px solid rgba(255, 255, 255, 0.25);border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#ccc;}#mermaid-1 rect.text{fill:none;stroke-width:0;}#mermaid-1 .icon-shape,#mermaid-1 .image-shape{background-color:#1f2937;text-align:center;}#mermaid-1 .icon-shape p,#mermaid-1 .image-shape p{background-color:#1f2937;padding:2px;}#mermaid-1 .icon-shape rect,#mermaid-1 .image-shape rect{opacity:0.5;background-color:#1f2937;fill:#1f2937;}#mermaid-1 .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-1 .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-1 :root{--mermaid-font-family:arial,sans-serif;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-1_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-1_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-1_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="mermaid-1_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-1_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="mermaid-1_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#mermaid-1_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_PR_CI_0" d="M130.801,62L130.801,66.167C130.801,70.333,130.801,78.667,130.801,86.333C130.801,94,130.801,101,130.801,104.5L130.801,108"></path><path marker-end="url(#mermaid-1_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_CI_Diff_0" d="M130.801,166L130.801,170.167C130.801,174.333,130.801,182.667,130.801,190.333C130.801,198,130.801,205,130.801,208.5L130.801,212"></path><path marker-end="url(#mermaid-1_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Diff_Green_0" d="M101.64,270L94.98,276.167C88.32,282.333,75,294.667,68.34,306.333C61.68,318,61.68,329,61.68,334.5L61.68,340"></path><path marker-end="url(#mermaid-1_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_Diff_Red_0" d="M159.961,270L166.621,276.167C173.281,282.333,186.602,294.667,193.262,306.333C199.922,318,199.922,329,199.922,334.5L199.922,340"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(61.6796875, 307)" class="edgeLabel"><g transform="translate(-32, -12)" class="label"><foreignObject height="24" width="64"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>差分なし</p></span></div></foreignObject></g></g><g transform="translate(199.921875, 307)" class="edgeLabel"><g transform="translate(-32, -12)" class="label"><foreignObject height="24" width="64"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>差分あり</p></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(130.80078125, 35)" id="flowchart-PR-0" class="node default"><rect height="54" width="150.71875" y="-27" x="-75.359375" style="" class="basic label-container"></rect><g transform="translate(-45.359375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="90.71875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Pull Request</p></span></div></foreignObject></g></g><g transform="translate(130.80078125, 139)" id="flowchart-CI-1" class="node default"><rect height="54" width="127.5" y="-27" x="-63.75" style="" class="basic label-container"></rect><g transform="translate(-33.75, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="67.5"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>CI ジョブ</p></span></div></foreignObject></g></g><g transform="translate(130.80078125, 243)" id="flowchart-Diff-3" class="node default"><rect height="54" width="219.046875" y="-27" x="-109.5234375" style="" class="basic label-container"></rect><g transform="translate(-79.5234375, -12)" style="" class="label"><rect></rect><foreignObject height="24" width="159.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>スキーマ差分チェック</p></span></div></foreignObject></g></g><g transform="translate(61.6796875, 371)" id="flowchart-Green-5" class="node default"><rect height="54" width="107.359375" y="-27" x="-53.6796875" ry="5" rx="5" style="fill:#A7F3D0 !important;stroke:#4ADE80 !important;stroke-width:2px !important" class="basic label-container"></rect><g transform="translate(-38.6796875, -12)" style="color:#065F46 !important" class="label"><rect></rect><foreignObject height="24" width="77.359375"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(6, 95, 70) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#065F46 !important"><p>Merge OK!</p></span></div></foreignObject></g></g><g transform="translate(199.921875, 371)" id="flowchart-Red-7" class="node default"><rect height="54" width="69.125" y="-27" x="-34.5625" ry="5" rx="5" style="fill:#FECACA !important;stroke:#F87171 !important;stroke-width:2px !important" class="basic label-container"></rect><g transform="translate(-19.5625, -12)" style="color:#7F1D1D !important" class="label"><rect></rect><foreignObject height="24" width="39.125"><div xmlns="http://www.w3.org/1999/xhtml" style="color: rgb(127, 29, 29) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel" style="color:#7F1D1D !important"><p>Block</p></span></div></foreignObject></g></g></g></g></g></svg>
<hr>
<h2 id="7-まとめai-時代の開発者マインドセット">7. まとめ：AI 時代の開発者マインドセット</h2>
<p>スキーマ駆動開発は <strong>“合意形成コストの前払い”</strong> が必要ですが、マルチチーム・マルチクライアント環境では効果が指数的に高まります。
生成AIと組み合わせることで、<strong>「人間が守るべき契約」を「AI が支援する継続的システム」</strong> として回せるようになります。</p>
<h2 id="zod--react-query-実装スケルトン">Zod + React Query 実装スケルトン</h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="ts"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { z } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "zod"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { useQuery } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "@tanstack/react-query"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> UserSchema</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> z.</span><span style="color:#B392F0">object</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">  id: z.</span><span style="color:#B392F0">string</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">uuid</span><span style="color:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#E1E4E8">  name: z.</span><span style="color:#B392F0">string</span><span style="color:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#E1E4E8">  email: z.</span><span style="color:#B392F0">string</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">email</span><span style="color:#E1E4E8">(),</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">type</span><span style="color:#B392F0"> User</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> z</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">infer</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#F97583">typeof</span><span style="color:#E1E4E8"> UserSchema>;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">async</span><span style="color:#F97583"> function</span><span style="color:#B392F0"> fetchUser</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">id</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Promise</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">User</span><span style="color:#E1E4E8">> {</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> res</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#B392F0"> fetch</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">`/api/users/${</span><span style="color:#E1E4E8">id</span><span style="color:#9ECBFF">}`</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">  const</span><span style="color:#79B8FF"> data</span><span style="color:#F97583"> =</span><span style="color:#F97583"> await</span><span style="color:#E1E4E8"> res.</span><span style="color:#B392F0">json</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#E1E4E8"> UserSchema.</span><span style="color:#B392F0">parse</span><span style="color:#E1E4E8">(data);</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">export</span><span style="color:#F97583"> function</span><span style="color:#B392F0"> useUser</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">id</span><span style="color:#F97583">:</span><span style="color:#79B8FF"> string</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">  return</span><span style="color:#B392F0"> useQuery</span><span style="color:#E1E4E8">({</span></span>
<span class="line"><span style="color:#E1E4E8">    queryKey: [</span><span style="color:#9ECBFF">"user"</span><span style="color:#E1E4E8">, id],</span></span>
<span class="line"><span style="color:#B392F0">    queryFn</span><span style="color:#E1E4E8">: () </span><span style="color:#F97583">=></span><span style="color:#B392F0"> fetchUser</span><span style="color:#E1E4E8">(id),</span></span>
<span class="line"><span style="color:#E1E4E8">  });</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="おわりに">おわりに</h2>
<p>スキーマ駆動開発は <strong>AI 補助・自動生成・契約保証・型安全</strong> を同時に享受できるモダン開発手法です。TypeSpec や Zod などのツールが成熟した今、小さなモジュールから導入してみてはいかがでしょうか。</p> </div> </div> <div class="footer"><div class="copyright">©︎ 2024 taisei miyaji</div><div class="icons"><span class="github"><a href="https://github.com/taiseimiyaji" target="_blank"><img src="/github-mark/github-mark-white.png" width="100%" height="100%" alt="github"/></a></span></div></div> </main> </body></html>