<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>ChatGPTを活用しながらRailsで個人開発をしてみる</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="
## はじめに

スマレジではLaravelをメインで使っているのですが副業で触っているRailsについては理解がまだまだ浅い部分があるため、個人開発でも触ってみたいと思います。

LaravelがRailsに影響を受けているフレームワー">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZBD90YGZ4N"></script><link rel="stylesheet" href="/_astro/activity.60e3b176.css" /><script type="module">window.dataLayer=window.dataLayer||[];function a(){dataLayer.push(arguments)}a("js",new Date);a("config","G-ZBD90YGZ4N");
</script></head>
  <!-- Google tag (gtag.js) -->
    
    
  <body>
    <main>
      <div class="header"><div class="title"><a href="/">Lyricrime.com</a></div><div class="header-link"><a href="/"><div> Blog</div></a><a href="/activity"><div>Activity</div></a><a href="/profile"><div>Profile</div></a></div></div>
      <div class="content">
        <div class="date">2023/06/07</div>
        <h1>ChatGPTを活用しながらRailsで個人開発をしてみる</h1>
        <div class="post">
          <h2 id="はじめに">はじめに</h2>
<p>スマレジではLaravelをメインで使っているのですが副業で触っているRailsについては理解がまだまだ浅い部分があるため、個人開発でも触ってみたいと思います。</p>
<p>LaravelがRailsに影響を受けているフレームワークでもあるため、Railsを触ることでLaravelに活かせる知見も獲得できることを期待しています。</p>
<h2 id="個人開発で作りたいもの">個人開発で作りたいもの</h2>
<p>以前の参加した勉強会で、技術書を読む時にアウトプットしながら読むと理解が深まるという話を聞きました。<br>
<a href="https://www.lyricrime.com/posts/2023-05-15-learning/">「勉強法の勉強会」参加レポと個人的な所感まとめ</a></p>
<p>ツイッターを例に挙げていたのですが、自分で見返すのが少ししんどそうだなと思ったので読書メモアプリを作ってみたいと思います。</p>
<p>イメージとしてはZennのScrapsをイメージしています。</p>
<h2 id="chatgptを活用してみる">ChatGPTを活用してみる</h2>
<p>今回の個人開発でのテーマは以下です。</p>
<ul>
<li>バックエンドはRails APIを使用する</li>
<li>フロントエンドはNext.jsのApp Routerを触ってみたい</li>
<li>雰囲気はZennのScrapsのイメージ</li>
</ul>
<p>これ以外の情報についてはあえてそこまで構想を練らずに着手してみます。</p>
<p>なお、本記事はすべてChat GPT4を使用していますので、課金しようか迷っている方は参考にしてみてください。</p>
<h3 id="第一の呪文-ドメインモデルを考える">第一の呪文 ドメインモデルを考える</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #c9d1d9">あなたはプロのエンジニアです。zennというサービスのScrapsのような形でスレッド形式で読書メモを残すサービスを考えています。この場合にどのようなモデルが考えられますか。なお、ユーザーごとのログイン機能を実装する予定です。</span></span></code></pre>
<p>回答</p>
<blockquote>
<p>このタイプのサービスを設計するためには、以下のようなデータモデルを考えることができます。</p>
<ol>
<li>
<p><strong>ユーザーモデル (User model)</strong>: ユーザーのログイン情報を管理するモデルです。名前、メールアドレス、パスワードのハッシュなどの情報を含むことが一般的です。</p>
</li>
<li>
<p><strong>読書メモモデル (ReadingNote model)</strong>: ユーザーが書く読書メモを管理するモデルです。メモの内容、作成日、最終更新日、関連する本のID、作成者（ユーザー）のIDなどを持つことが考えられます。</p>
</li>
<li>
<p><strong>本モデル (Book model)</strong>: メモが関連付けられる本を管理するモデルです。本のタイトル、著者、出版年、ISBNなどの情報を含むことが一般的です。</p>
</li>
<li>
<p><strong>スレッドモデル (Thread model)</strong>: 同じ本に関連するメモをまとめるためのスレッドを管理するモデルです。スレッドのタイトル、作成日、最終更新日、関連する本のID、スレッドの作成者（ユーザー）のIDなどを持つことが考えられます。</p>
</li>
<li>
<p><strong>コメントモデル (Comment model)</strong>: スレッド内の各読書メモに対するコメントを管理するモデルです。コメントの内容、作成日、最終更新日、関連する読書メモのID、コメントの作成者（ユーザー）のIDなどを持つことが考えられます。</p>
</li>
</ol>
<p>以上のモデルは、各モデル間のリレーションシップ（関連）を考慮して作成する必要があります。例えば、読書メモモデルは作成者（ユーザーモデル）とのリレーションシップ、本モデルとのリレーションシップを持つべきです。同様に、コメントモデルは読書メモモデルとユーザーモデルとのリレーションシップを持つべきです。</p>
<p>これらのモデルはあくまで基本的なもので、具体的な要件やユースケースによりますので、必要に応じて拡張や修正が必要になるかもしれません。</p>
</blockquote>
<p>はい、いうことなしです。というかそこまで深く考えてない状態で投げているので特に指摘する点も見つかりません。</p>
<p>ユーザーのログインについては以前の記事で紹介した通りOpenIDConnectのImplicit Flowを使って実装してみたいと思います。</p>
<p>参考: <a href="https://www.lyricrime.com/posts/oidc-login/">OIDCを使用したクライアントシークレットなしでのソーシャルログイン実装について調査してみる
</a></p>
<p>ひとまず今回は本(Book)モデルから進めてみましょう。</p>
<h3 id="第二の呪文-本モデルbooksの作成">第二の呪文 本モデル(Books)の作成</h3>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #c9d1d9">上記のうち、本モデルについてのCRUD処理をRails APIを用いて作成します。この場合の手順と具体的なコード例を教えてください</span></span></code></pre>
<p>回答</p>
<blockquote>
<p>Ruby on Railsを使用して本のモデルとそのCRUD操作を作成するには以下の手順を守ります。以下の例では、コマンドラインとエディタを使用します。</p>
<ol>
<li><strong>本のモデルの作成</strong></li>
</ol>
<p>まずはじめに本のモデルを作成します。ターミナルで次のコマンドを実行します。</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #c9d1d9">rails g model Book title:string author:string publication_year:integer isbn:string</span></span></code></pre>
<p>このコマンドで<code>Book</code>という名前のモデルが作成され、それに対応するマイグレーションファイルが生成されます。モデルには、<code>title</code>, <code>author</code>, <code>publication_year</code>, <code>isbn</code>という4つの属性を追加します。</p>
<ol start="2">
<li><strong>データベースのマイグレーション</strong></li>
</ol>
<p>生成したマイグレーションファイルをデータベースに適用します。ターミナルで次のコマンドを実行します。</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #c9d1d9">rails db:migrate</span></span></code></pre>
<ol start="3">
<li><strong>本のコントローラーの作成</strong></li>
</ol>
<p>次に、本のCRUD操作を処理するコントローラーを作成します。ターミナルで次のコマンドを実行します。</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #c9d1d9">rails g controller Books</span></span></code></pre>
<ol start="4">
<li><strong>ルーティングの設定</strong></li>
</ol>
<p><code>config/routes.rb</code> ファイルを開き、以下のように設定します。</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #79C0FF">Rails</span><span style="color: #C9D1D9">.application.routes.draw </span><span style="color: #FF7B72">do</span></span>
<span class="line"><span style="color: #C9D1D9"> resources </span><span style="color: #79C0FF">:books</span></span>
<span class="line"><span style="color: #FF7B72">end</span></span></code></pre>
<p>これで <code>books</code> コントローラーに対するルーティングが自動で設定されます。</p>
<ol start="5">
<li><strong>コントローラーにCRUD操作を追加</strong></li>
</ol>
<p><code>app/controllers/books_controller.rb</code> ファイルを開き、CRUD操作を追加します。</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FF7B72">class</span><span style="color: #C9D1D9"> </span><span style="color: #FFA657">BooksController</span><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ApplicationController</span></span>
<span class="line"><span style="color: #C9D1D9"> before_action </span><span style="color: #79C0FF">:set_book</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">only:</span><span style="color: #C9D1D9"> [</span><span style="color: #79C0FF">:show</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">:update</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">:destroy</span><span style="color: #C9D1D9">]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #8B949E"># GET /books</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">def</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">index</span></span>
<span class="line"><span style="color: #C9D1D9">   @books </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Book</span><span style="color: #C9D1D9">.all</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">   render </span><span style="color: #79C0FF">json:</span><span style="color: #C9D1D9"> @books</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">end</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #8B949E"># GET /books/1</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">def</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">show</span></span>
<span class="line"><span style="color: #C9D1D9">   render </span><span style="color: #79C0FF">json:</span><span style="color: #C9D1D9"> @book</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">end</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #8B949E"># POST /books</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">def</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">create</span></span>
<span class="line"><span style="color: #C9D1D9">   @book </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Book</span><span style="color: #C9D1D9">.</span><span style="color: #FF7B72">new</span><span style="color: #C9D1D9">(book_params)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> @book.save</span></span>
<span class="line"><span style="color: #C9D1D9">     render </span><span style="color: #79C0FF">json:</span><span style="color: #C9D1D9"> @book, </span><span style="color: #79C0FF">status:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">:created</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">location:</span><span style="color: #C9D1D9"> @book</span></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">else</span></span>
<span class="line"><span style="color: #C9D1D9">     render </span><span style="color: #79C0FF">json:</span><span style="color: #C9D1D9"> @book.errors, </span><span style="color: #79C0FF">status:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">:unprocessable_entity</span></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">end</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">end</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #8B949E"># PATCH/PUT /books/1</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">def</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">update</span></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">if</span><span style="color: #C9D1D9"> @book.update(book_params)</span></span>
<span class="line"><span style="color: #C9D1D9">     render </span><span style="color: #79C0FF">json:</span><span style="color: #C9D1D9"> @book</span></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">else</span></span>
<span class="line"><span style="color: #C9D1D9">     render </span><span style="color: #79C0FF">json:</span><span style="color: #C9D1D9"> @book.errors, </span><span style="color: #79C0FF">status:</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">:unprocessable_entity</span></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">end</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">end</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #8B949E"># DELETE /books/1</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">def</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">destroy</span></span>
<span class="line"><span style="color: #C9D1D9">   @book.destroy</span></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">end</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9"> </span><span style="color: #FF7B72">private</span></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">def</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">set_book</span></span>
<span class="line"><span style="color: #C9D1D9">     @book </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">Book</span><span style="color: #C9D1D9">.find(params[</span><span style="color: #79C0FF">:id</span><span style="color: #C9D1D9">])</span></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">end</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">def</span><span style="color: #C9D1D9"> </span><span style="color: #D2A8FF">book_params</span></span>
<span class="line"><span style="color: #C9D1D9">     params.require(</span><span style="color: #79C0FF">:book</span><span style="color: #C9D1D9">).permit(</span><span style="color: #79C0FF">:title</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">:author</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">:publication_year</span><span style="color: #C9D1D9">, </span><span style="color: #79C0FF">:isbn</span><span style="color: #C9D1D9">)</span></span>
<span class="line"><span style="color: #C9D1D9">   </span><span style="color: #FF7B72">end</span></span>
<span class="line"><span style="color: #FF7B72">end</span></span></code></pre>
<p>これにより、BookモデルのCRUD操作が可能になります。すべての操作はJSON形式</p>
<p>でデータを返すように設定されています。各操作はHTTPリクエスト(GET, POST, PUT/PATCH, DELETE)と対応しています。</p>
<p>以上が基本的な手順となります。APIの設定はアプリケーションのニーズに応じて変更することができます。また、エラーハンドリングやセキュリティの観点（認証、認可）から見た場合、さらなる改善が必要となるでしょう。</p>
</blockquote>
<p>具体的な方法についての回答が得られました。</p>
<p>ただ、経験上ChatGPTは嘘をつく、知ったかぶりをした回答をすることが多いため、きちんと裏を取る必要があります。</p>
<p>特に自分に知見がない分野の場合は注意が必要で、一見正しく見えるそれっぽい回答を吐くことが多々あります。</p>
<h3 id="モデルの生成--ルーティングの設定">モデルの生成 ~ ルーティングの設定</h3>
<p>先程生成された回答のうち、コマンドを提示されるものについては公式ドキュメントを見れば意図通りの出力かどうかを確認できます。</p>
<p>参考: <a href="https://railsguides.jp/active_record_migrations.html#%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B">https://railsguides.jp/active_record_migrations.html#%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B</a></p>
<h3 id="コントローラーにcrud操作を追加">コントローラーにCRUD操作を追加</h3>
<p>コントローラーの実装も公式ドキュメントを見ながら確認します。
また、基本的なコントローラに関する知識は公式ドキュメントにまとまっているので、こちらも参考にすると良いでしょう。</p>
<p>参考: <a href="https://railsguides.jp/action_controller_overview.html">https://railsguides.jp/action_controller_overview.html</a></p>
<h3 id="不足している点">不足している点</h3>
<p>先程のChatGPTの回答で不足している点は、以下のようなものになります。</p>
<ul>
<li>エラーハンドリング</li>
<li>入力値のバリデーション</li>
<li>具体的なロジックの説明</li>
</ul>
<p>単純に動くものとしては何度か質問を繰り返すと作成できるかと思いますが、実際にはエラーハンドリングやバリデーションといった部分をコントロールしようと思うと人間が考える必要があります。</p>
<p>また、Railsのフレームワークに関する知識の回答が少ないため、コードを出力させたうえで、知らない言語知識について公式ドキュメントで調べるという手順を踏む必要があります。</p>
<h2 id="まとめ">まとめ</h2>
<p>今回はChatGPTを用いて、RailsのAPIを作成する方法を紹介しました。</p>
<p>個人開発等では、モデルの作成から実際のコーディングまで、幅広い分野での活用が期待できそうです。</p>
<p>ただ、ChatGPTは嘘をつくことが多いため、回答をそのまま鵜呑みにせず、公式ドキュメントを確認することが重要です。</p>
<p>個人的にはGitHub CopilotやChatGPTを使用することでAPIとペアプロをしている気分になって個人開発も楽しく進められるようになったなと思います。</p>
<p>最低限の問題解決能力がないとChatGPTを使用しても詰まってしまうことが多いのですが、問題解決の際にもかなり役に立つなと思いました。</p>
<p>これからも活用の方法を工夫しながら自身の成長を加速させるためにAI技術を使用してみたいと思います。</p>
        </div>
      </div>
      <div class="footer"><div class="copyright">©︎ 2023 taisei miyaji</div><div class="icons"><span class="github"><a href="https://github.com/taiseimiyaji" target="_blank"><img src="/github-mark/github-mark-white.png" width="100%" height="100%" alt="github"/></a></span></div></div>
    </main>
  </body></html>